<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar Colorizer Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        .console-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 10px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
        }
        button:hover {
            background: #45a049;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.warning { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <h1>üß™ User Calendar Colorizer - Diagnostic Tool</h1>
    
    <div class="test-section">
        <h2>Test Configuration</h2>
        <label>User ID: <input type="text" id="userIdInput" value="12552282" style="padding: 5px; width: 200px;"></label>
        <button onclick="runTest()">üöÄ Run Test</button>
        <button onclick="clearConsole()">üóëÔ∏è Clear Console</button>
        <div id="status"></div>
    </div>

    <div class="test-section">
        <h2>Test Calendars</h2>
        <p>Multiple months to test with. Scroll to see all months:</p>
        
        <h3>October 2025</h3>
        <table>
            <tr>
                <td class="fc-day" data-date="2025-10-01">1</td>
                <td class="fc-day" data-date="2025-10-02">2</td>
                <td class="fc-day" data-date="2025-10-03">3</td>
                <td class="fc-day" data-date="2025-10-04">4</td>
                <td class="fc-day" data-date="2025-10-05">5</td>
            </tr>
            <tr>
                <td class="fc-day" data-date="2025-10-06">6</td>
                <td class="fc-day" data-date="2025-10-07">7</td>
                <td class="fc-day" data-date="2025-10-08">8</td>
                <td class="fc-day" data-date="2025-10-09">9</td>
                <td class="fc-day" data-date="2025-10-10">10</td>
            </tr>
            <tr>
                <td class="fc-day" data-date="2025-10-11">11</td>
                <td class="fc-day" data-date="2025-10-12">12</td>
                <td class="fc-day" data-date="2025-10-13">13</td>
                <td class="fc-day" data-date="2025-10-14">14</td>
                <td class="fc-day" data-date="2025-10-15">15</td>
            </tr>
            <tr>
                <td class="fc-day" data-date="2025-10-16">16</td>
                <td class="fc-day" data-date="2025-10-17">17</td>
                <td class="fc-day" data-date="2025-10-18">18</td>
                <td class="fc-day" data-date="2025-10-19">19</td>
                <td class="fc-day" data-date="2025-10-20">20</td>
            </tr>
            <tr>
                <td class="fc-day" data-date="2025-10-21">21</td>
                <td class="fc-day" data-date="2025-10-22">22</td>
                <td class="fc-day" data-date="2025-10-23">23</td>
                <td class="fc-day" data-date="2025-10-24">24</td>
                <td class="fc-day" data-date="2025-10-25">25</td>
            </tr>
        </table>

        <h3>November 2025</h3>
        <table>
            <tr>
                <td class="fc-day" data-date="2025-11-01">1</td>
                <td class="fc-day" data-date="2025-11-02">2</td>
                <td class="fc-day" data-date="2025-11-03">3</td>
                <td class="fc-day" data-date="2025-11-04">4</td>
                <td class="fc-day" data-date="2025-11-05">5</td>
            </tr>
            <tr>
                <td class="fc-day" data-date="2025-11-06">6</td>
                <td class="fc-day" data-date="2025-11-07">7</td>
                <td class="fc-day" data-date="2025-11-08">8</td>
                <td class="fc-day" data-date="2025-11-09">9</td>
                <td class="fc-day" data-date="2025-11-10">10</td>
            </tr>
            <tr>
                <td class="fc-day" data-date="2025-11-11">11</td>
                <td class="fc-day" data-date="2025-11-12">12</td>
                <td class="fc-day" data-date="2025-11-13">13</td>
                <td class="fc-day" data-date="2025-11-14">14</td>
                <td class="fc-day" data-date="2025-11-15">15</td>
            </tr>
            <tr>
                <td class="fc-day" data-date="2025-11-16">16</td>
                <td class="fc-day" data-date="2025-11-17">17</td>
                <td class="fc-day" data-date="2025-11-18">18</td>
                <td class="fc-day" data-date="2025-11-19">19</td>
                <td class="fc-day" data-date="2025-11-20">20</td>
            </tr>
        </table>

        <h3>December 2025</h3>
        <table>
            <tr>
                <td class="fc-day" data-date="2025-12-01">1</td>
                <td class="fc-day" data-date="2025-12-02">2</td>
                <td class="fc-day" data-date="2025-12-03">3</td>
                <td class="fc-day" data-date="2025-12-04">4</td>
                <td class="fc-day" data-date="2025-12-05">5</td>
            </tr>
            <tr>
                <td class="fc-day" data-date="2025-12-06">6</td>
                <td class="fc-day" data-date="2025-12-07">7</td>
                <td class="fc-day" data-date="2025-12-08">8</td>
                <td class="fc-day" data-date="2025-12-09">9</td>
                <td class="fc-day" data-date="2025-12-10">10</td>
            </tr>
            <tr>
                <td class="fc-day" data-date="2025-12-11">11</td>
                <td class="fc-day" data-date="2025-12-12">12</td>
                <td class="fc-day" data-date="2025-12-13">13</td>
                <td class="fc-day" data-date="2025-12-14">14</td>
                <td class="fc-day" data-date="2025-12-15">15</td>
            </tr>
            <tr>
                <td class="fc-day" data-date="2025-12-16">16</td>
                <td class="fc-day" data-date="2025-12-17">17</td>
                <td class="fc-day" data-date="2025-12-18">18</td>
                <td class="fc-day" data-date="2025-12-19">19</td>
                <td class="fc-day" data-date="2025-12-20">20</td>
            </tr>
        </table>
    </div>

    <div class="test-section">
        <h2>Console Output</h2>
        <div id="consoleOutput" class="console-output">
            Console output will appear here...
        </div>
    </div>

    <script src="user_calendar_colorizer.js"></script>
    <script>
        // Capture console logs
        const consoleDiv = document.getElementById('consoleOutput');
        const statusDiv = document.getElementById('status');
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;

        function addToConsole(message, type = 'log') {
            const colors = {
                log: '#d4d4d4',
                warn: '#ffa500',
                error: '#ff4444'
            };
            const line = document.createElement('div');
            line.style.color = colors[type];
            line.style.margin = '2px 0';
            line.textContent = `[${type.toUpperCase()}] ${message}`;
            consoleDiv.appendChild(line);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsole(args.join(' '), 'log');
        };

        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToConsole(args.join(' '), 'warn');
        };

        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsole(args.join(' '), 'error');
        };

        function clearConsole() {
            consoleDiv.innerHTML = 'Console cleared...\n';
        }

        async function runTest() {
            clearConsole();
            statusDiv.innerHTML = '';
            
            const userId = document.getElementById('userIdInput').value;
            
            if (!userId) {
                statusDiv.innerHTML = '<div class="status error">‚ùå Please enter a user ID</div>';
                return;
            }

            statusDiv.innerHTML = '<div class="status warning">‚è≥ Running test...</div>';
            
            try {
                // Clear any previous colors
                document.querySelectorAll('td.fc-day').forEach(cell => {
                    cell.style.removeProperty('background-color');
                    cell.removeAttribute('data-ma-count');
                    cell.removeAttribute('title');
                });

                console.log('==============================================');
                console.log('STARTING CALENDAR COLORIZER TEST');
                console.log('==============================================');
                
                await initUserCalendarColorizer(userId);
                
                // Check results
                const coloredCells = document.querySelectorAll('td.fc-day[data-ma-count]');
                
                if (coloredCells.length > 0) {
                    statusDiv.innerHTML = `<div class="status success">‚úÖ Success! Colored ${coloredCells.length} calendar cells. Check the calendar above and console output below.</div>`;
                } else {
                    statusDiv.innerHTML = '<div class="status warning">‚ö†Ô∏è Test completed but no cells were colored. Check console output for details.</div>';
                }
                
            } catch (error) {
                console.error('Test failed:', error);
                statusDiv.innerHTML = `<div class="status error">‚ùå Test failed: ${error.message}</div>`;
            }
        }

        // Run test automatically on load
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('Page loaded. Click "Run Test" to start or it will auto-run in 2 seconds...');
                setTimeout(runTest, 2000);
            }, 100);
        });
    </script>
</body>
</html>
